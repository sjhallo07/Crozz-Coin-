#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Running pre-push checks..."

# Run tests
echo "ğŸ§ª Running tests..."
npm run test || {
    echo "âŒ Tests failed! Push aborted."
    exit 1
}

# Run security audit
echo "ğŸ”’ Running security audit..."
npm audit --audit-level=high || {
    echo "âš ï¸  Security vulnerabilities detected!"
    echo "Consider running 'npm audit fix' before pushing."
    read -p "Continue with push? (y/N) " -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        exit 1
    fi
}

echo "âœ… Pre-push checks passed!"
